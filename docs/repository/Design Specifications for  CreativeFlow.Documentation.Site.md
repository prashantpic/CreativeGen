# Software Design Specification (SDS): CreativeFlow.Documentation.Site

## 1. Introduction

### 1.1. Purpose
This document outlines the software design and technical specifications for the `CreativeFlow.Documentation.Site` repository. This repository is responsible for building and maintaining the official documentation portal for the CreativeFlow AI platform. The portal will serve as a comprehensive resource for multiple audiences, including end-users, API developers, and internal technical staff.

### 1.2. Scope
The scope of this SDS covers the technical implementation of the documentation site using the Docusaurus static site generator. This includes the site's architecture, configuration, content structure, CI/CD integration, and key features such as API reference rendering, search, and multi-audience content organization. The content itself will be sourced from various project artifacts as specified in the requirements (`REQ-018`, `REQ-022`, `NFR-010`, `Appendix B`, `DEP-005`).

## 2. System Architecture & Design

### 2.1. Architectural Style
The documentation portal will be a **monolithic static website** generated by Docusaurus. This approach is chosen for its performance, security, simplicity of deployment, and excellent support for content-rich sites based on Markdown.

### 2.2. Technology Stack
*   **Static Site Generator:** Docusaurus 3.4.0+
*   **Language:** Markdown, MDX, TypeScript 5.5.3+
*   **Framework:** React 18.3.1+ (as used by Docusaurus)
*   **Styling:** Infima CSS Framework (built into Docusaurus)
*   **Runtime:** Node.js 20.15.1+ (for building the site)
*   **API Documentation:** `docusaurus-openapi-docs` plugin
*   **Search:** Algolia DocSearch

### 2.3. Core Configuration Files

#### 2.3.1. `package.json`
This file defines the project's dependencies and scripts.

*   **Dependencies:**
    *   `@docusaurus/core`: Core Docusaurus framework.
    *   `@docusaurus/preset-classic`: Standard preset including docs, blog, pages, and theme.
    *   `react`, `react-dom`: Peer dependencies for Docusaurus.
    *   `clsx`: Utility for constructing `className` strings.
    *   `docusaurus-openapi-docs`: Plugin for rendering OpenAPI specifications.
*   **Scripts:**
    *   `"start"`: Runs `docusaurus start` to launch the local development server.
    *   `"build"`: Runs `docusaurus build` to generate the static site into the `/build` directory.
    *   `"swizzle"`: Runs `docusaurus swizzle` for theme component customization.
    *   `"deploy"`: Runs `docusaurus deploy` to deploy the site to the configured host (e.g., GitHub Pages, Netlify).
    *   `"serve"`: Runs `docusaurus serve` to serve the built site locally for verification.

#### 2.3.2. `docusaurus.config.js`
This is the master configuration file for the entire site.

*   **Site Metadata:**
    *   `title`: 'CreativeFlow AI Documentation'
    *   `tagline`: 'The official documentation for the CreativeFlow AI Platform.'
    *   `favicon`: 'img/favicon.ico'
    *   `url`: 'https://docs.creativeflow.ai' (Production URL)
    *   `baseUrl`: '/'
*   **Theme Configuration (`themeConfig`):**
    *   **Navbar:**
        *   Logo pointing to the homepage.
        *   Items will include links to top-level documentation sections: 'User Guide', 'Developer Portal', 'Architecture', 'Operations', 'FAQ'.
        *   A link to the main product marketing site.
    *   **Footer:**
        *   Links to documentation sections, community forums, and company social media.
        *   Copyright notice.
    *   **Prism:**
        *   Configuration for code block syntax highlighting. Include additional languages like `python`, `yaml`, `json`, `dart`.
    *   **Algolia:**
        *   Configuration for DocSearch, including `appId`, `apiKey`, and `indexName`. This will be the primary search mechanism.
*   **Presets (`@docusaurus/preset-classic`):**
    *   **docs:**
        *   `path`: 'docs'
        *   `sidebarPath`: `require.resolve('./sidebars.js')`
        *   `routeBasePath`: '/' (to serve docs from the root)
    *   **blog:**
        *   Set to `false` as no blog is initially required.
*   **Plugins:**
    *   **`docusaurus-openapi-docs`:**
        *   Will be configured to process OpenAPI spec files located in `static/api-specs/`.
        *   Each API will have its own configuration block defining its ID, spec path, and output directory within the docs.
        javascript
        // Example configuration within plugins array
        [
          'docusaurus-openapi-docs',
          {
            id: 'apiDocs',
            config: {
              'creative-generation': { // API id
                specPath: 'static/api-specs/creative-generation-api.v1.yaml', // Path to the spec file
                outputDir: 'docs/developer-portal/api-reference/creative-generation', // Output directory
                sidebarOptions: {
                  groupPathsBy: 'tag',
                },
              },
              // ... other APIs
            }
          }
        ]
        

#### 2.3.3. `sidebars.js`
This file defines the navigation structure for the documentation content.

*   A single primary sidebar will be defined.
*   **Structure:**
    *   **Introduction:** A single link to `introduction.md`.
    *   **User Guide:** Can be auto-generated from the `/docs/user-guide` directory.
    *   **Developer Portal:** Manually structured to ensure a logical flow.
        *   Getting Started
        *   Authentication
        *   API Reference (Category)
            *   Overview
            *   Creative Generation API (links to the `docusaurus-openapi-docs` generated sidebar)
            *   ... other APIs
    *   **Architecture:** Manually structured.
        *   Overview
        *   Architectural Decision Records (ADR) (Category)
    *   **Operations:** Manually structured.
        *   Maintenance Procedures
        *   Backup & Disaster Recovery
    *   **FAQ & Knowledge Base:** Can be auto-generated.

## 3. Content Implementation and Structure

### 3.1. `docs/` Directory
This directory houses all Markdown and MDX content files.

*   **`introduction.md`**: The site's landing page. It must contain a brief overview of the platform and sections with links tailored to different user personas (End-Users, Developers, Admins) to guide them to the correct documentation areas.

*   **`docs/architecture/`**:
    *   `overview.mdx`: This file will provide a narrative description of the system's microservices architecture. It will embed the primary `system-architecture.svg` diagram using an `<img>` tag or a custom React component for better styling.
    *   `adr/*.md`: Each file will follow the standard Architectural Decision Record format (Context, Decision, Consequences) to document key technical choices.

*   **`docs/developer-portal/`**:
    *   `api-reference/overview.md`: A crucial document explaining universal API concepts: authentication methods (API Key), versioning strategy, rate limiting policies, and a comprehensive list of common error codes and their meanings.
    *   `api-reference/creative-generation-api.mdx` (and similar for other APIs): This file will primarily be a host for the OpenAPI-generated documentation. The content will be minimal, using the syntax provided by the `docusaurus-openapi-docs` plugin to render the interactive API explorer. Example:
        mdx
        ---
        title: Creative Generation API
        ---

        import API from '@theme/ApiItem';

        <API />
        
        The frontmatter and component usage will be driven by the plugin's configuration in `docusaurus.config.js`.

*   **`docs/operations/`**:
    *   These files will contain procedural "runbook" style content. Use clear headings, numbered lists for steps, and `<code>` blocks for commands.
    *   `maintenance-procedures.md`: Will detail SOPs for patching, upgrades, etc.
    *   `backup-and-disaster-recovery.md`: Will contain the full DR plan, including failover and failback steps.

*   **`docs/faq-kb/`**:
    *   Content will be structured in a simple Q&A format. Each question should be a heading (`##` or `###`) to be easily linkable and discoverable by search.

*   **`docs/training-materials/`**:
    *   Content will be structured as step-by-step tutorials. Screenshots will be stored in `/static/img/tutorials/` and embedded using standard Markdown image syntax.

### 3.2. `static/` Directory
This directory holds assets that are copied directly to the `build` output.

*   **`static/api-specs/*.yaml`**:
    *   This directory is the single source of truth for all public-facing API contracts.
    *   Files must adhere to the OpenAPI 3.x specification.
    *   These files must be rigorously version-controlled. The CI/CD process should ideally include a linting step for these YAML files (e.g., using `redocly/cli lint`).

*   **`static/img/` and `static/diagrams/`**:
    *   Store all images, logos, and diagrams here.
    *   Diagrams like `system-architecture.svg` and `database-erds.png` are critical architectural artifacts and should be updated as the system evolves.

## 4. Key Functionality Implementation

### 4.1. Search
Search functionality will be implemented using **Algolia DocSearch**. This requires:
1.  Applying for the DocSearch program.
2.  Configuring the `algolia` block in `docusaurus.config.js` with the provided `appId`, `apiKey`, and `indexName`.
3.  Docusaurus will automatically handle the UI integration. The Algolia crawler will be configured to scrape and index the production site.

### 4.2. Diagrams and Visualizations
*   **Static Diagrams:** Complex, high-level diagrams (e.g., System Architecture, ERDs) will be created using external tools (draw.io, PlantUML) and exported as SVG or PNG files. They will be stored in `/static/diagrams/` and embedded in `.mdx` or `.md` files.
*   **Dynamic/Code-based Diagrams:** For simpler diagrams like sequence or flow charts within documentation, **Mermaid.js** support will be enabled. This allows diagrams to be written as code directly within Markdown files, ensuring they are version-controlled and easier to update. This is a built-in feature of `@docusaurus/preset-classic` and should be leveraged.

## 5. CI/CD and Deployment Strategy
1.  **Source Control:** All documentation content, configuration, and assets will be stored in a Git repository.
2.  **Continuous Integration:** The project's main CI/CD pipeline (GitLab CI/CD or GitHub Actions) will have a dedicated job for the documentation site.
3.  **CI Pipeline Steps:**
    *   On every commit/PR to a feature branch:
        1.  `npm install`: Install dependencies.
        2.  `npm run build`: Run a production build to check for errors.
        3.  `npx @redocly/cli lint static/api-specs/*.yaml`: Lint all OpenAPI spec files for correctness.
4.  **Continuous Deployment:**
    *   On every merge to the `main` branch:
        1.  Execute all CI steps.
        2.  `npm run deploy`: Run the Docusaurus deploy command to publish the contents of the `/build` directory to the production hosting environment (e.g., push to `gh-pages` branch, or use a dedicated deployment service integration).

## 6. Adherence to Requirements
*   **REQ-018 & Appendix B (Developer Portal):** Addressed by the `docs/developer-portal/` section, the `docusaurus-openapi-docs` plugin, and the version-controlled OpenAPI specs in `/static/api-specs/`.
*   **REQ-022 (Self-Service):** Addressed by the `docs/faq-kb/` section and the integration of Algolia search.
*   **NFR-010 & Appendix B (Technical Docs):** Addressed by the `docs/architecture/`, `docs/operations/` sections, and the inclusion of diagrams in `/static/diagrams/`.
*   **DEP-005 (Maintenance Docs):** Addressed by `docs/operations/maintenance-procedures.md`.
*   **11.4.3 (Training Materials):** Addressed by the `docs/training-materials/` section.